<!DOCTYPE html>
<html>
<head>
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0" charset='utf-8'.> -->
  <meta charset='utf8'>
  <!-- <style >.hogehoge {
    padding: 20px;
    margin: 20px;
  }
  /* .wrapper{
  width: 100%;
  height: 100%;
} */
  </style> -->
  <script async src="opencv.js" type="text/javascript" onload="OpenCvReady();"></script>
  <!-- <script async src="https://docs.opencv.org/4.x/opencv.js" type="text/javascript" onload="OpenCvReady();"></script> -->
</head>
<body>
  
  <div class="camera">
    <video id="video" autoplay playsinline></video>
</div><br>
<canvas id="movie" ></canvas>
<canvas id="canvas"></canvas>

<!-- <img id="image" src="sakura.png" alt="example"> -->

<p id="text"></p>

<button class="hogehoge" type="button" id="start">start</button>
<!-- <button class="hogehoge" type="button" id="stop">stop</button> -->
<!-- <botton type="button" id="download">dl</botton> -->

<script>
  const canvas = document.getElementById('canvas')
  const ctx = canvas.getContext("2d");
  ctx.strokeStyle = '#333'; // 塗りつぶしは暗めの色
    ctx.fillStyle = '#f00'; // 線は赤色
    ctx.lineWidth = 5; // 線の幅は5px

    /* 円の描画 */
    ctx.beginPath(); // パスの初期化
    ctx.arc(100, 50, 30, 0, 2 * Math.PI); // (100, 50)の位置に半径30pxの円
    ctx.closePath(); // パスを閉じる
    ctx.fill(); // 軌跡の範囲を塗りつぶす
  video.style = 'display:none';
  video.muted = 'true';
  movie.style = 'display:none';
  function OpenCvReady(){
    console.log("a");
    let img = cv.imread(canvas);
    console.log("b");
    let points = [[10, 10], [20, 10], [20, 20], [10, 20]];
    let ptsMat = cv.matFromArray(1, points.length, cv.CV_32SC2, points.flat());

    console.log("c");
    cv.polylines(img, [ptsMat], true, new cv.Scalar(255, 0, 0), 2, cv.LINE_AA);
    console.log("d");
    cv.imshow("canvas", img);

    ptsMat.delete();
    img.delete();
  }
</script>
</body>
</html>